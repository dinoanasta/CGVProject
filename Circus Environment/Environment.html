<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<script src = "../js/three.js"></script>
<script src = "../js/OrbitControls.js"></script>
<script src = "../js/physi.js"></script>
<script src = "../js/GLTFLoader.js"></script>
<script>


    Physijs.scripts.worker =  '../js/physijs_worker.js';
    Physijs.scripts.ammo = '../js/ammo.js';
    var frameNumber = 0;
    var cylinder1, cylinder2,cylinder3,cylinder4;
    var renderer = new THREE.WebGLRenderer({antialias:true});
    var camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 10000 );
    // var scene = new THREE.Scene();
    var scene = new Physijs.Scene;
    scene.setGravity(new THREE.Vector3(0,-10,0));

    // renderer.setSize( 1000, 800);
    renderer.setSize(window.innerWidth,window.innerHeight);
    document.body.appendChild( renderer.domElement );

    renderer.setClearColor(0xFFFFFF); //0x07E2E9
    var light;  // A light shining from the direction of the camera; moves with the camera.
    light = new THREE.DirectionalLight(0xFFFFFF,0.6);
    light.position.set(0,0,1);
    camera.add(light);
    scene.add(camera);

    function Plane() {
        var texture = new THREE.TextureLoader().load('../Resources/Textures/Razeen/BlackBlocks.jpg');
        var surfaceMaterial = new THREE.MeshPhongMaterial({
            //color: 0xE6E686,
            //specular: 0x222222,
            shininess: 16,
            shading: THREE.FlatShading,
            map: texture
        });
       // map: THREE.ImageUtils.loadTexture('textures/grass.jpg')
        var surfaceGeometry = new THREE.BoxGeometry(500,500);
        var ground = new Physijs.createMaterial(surfaceMaterial,0.1,50);
        var value = 0;

        var groundShape = new Physijs.BoxMesh(surfaceGeometry,surfaceMaterial,0);
        var light2 = new THREE.AmbientLight(0xE6E686);
        groundShape.add(light2);
        groundShape.rotation.x = -0.5*Math.PI;
        return groundShape;
    }

    scene.add(Plane());

    function CreateBarrier(StartX,StartY, StartZ) {
        var wholeBarrier = new THREE.Object3D();

        var texture1 = new THREE.TextureLoader().load("../Resources/Textures/Razeen/yellow.jpg");
        var texture2 = new THREE.TextureLoader().load("../Resources/Textures/Razeen/red.jpg");
        var texture3 = new THREE.TextureLoader().load("../Resources/Textures/Razeen/purple.jpg");
        var texture4 = new THREE.TextureLoader().load("../Resources/Textures/Razeen/blue2.jpg");
        var geo = new THREE.CylinderGeometry(10,10,300,50,50);

        var mat1 = new THREE.MeshPhongMaterial({
            shininess: 0.8,
            emissive : 0xFFFB09,
            emissiveIntensity: 0.4,
            color: 0xFFFFFF,
            map: texture1
        });
        var mat2 = new THREE.MeshPhongMaterial({
            shininess: 0.8,
            emissive : 0xFF091C,
            emissiveIntensity: 0.4,
            specular: 0xf0f0f0,
            color: 0xFFFFFF,
            map: texture2
        });
        var mat3 = new THREE.MeshPhongMaterial({
            shininess: 0.8,
            emissive : 0x9207AB,
            emissiveIntensity: 0.4,
            specular: 0xf0f0f0,
            color: 0xFFFFFF,
            map: texture3
        });
        var mat4 = new THREE.MeshPhongMaterial({
            shininess: 0.8,
            emissive : 0x069AFA,
            emissiveIntensity: 0.4,
            specular: 0xf0f0f0,
            color: 0xFFFFFF,
            map: texture4
        });
        cylinder1 = new Physijs.CylinderMesh(geo,mat1,0);
        cylinder1.position.x = StartX;
        cylinder1.position.y = StartY;
        cylinder1.position.z = StartZ;
        wholeBarrier.add(cylinder1);

        cylinder2 = new Physijs.CylinderMesh(geo,mat2,0);
        cylinder2.position.x = StartX+40;
        cylinder2.position.y = StartY;
        cylinder2.position.z = StartZ+30;
        wholeBarrier.add(cylinder2);

        cylinder3 = new Physijs.CylinderMesh(geo,mat3,0);
        cylinder3.position.x = StartX+80;
        cylinder3.position.y = StartY;
        cylinder3.position.z = StartZ;
        wholeBarrier.add(cylinder3);

        cylinder4 = new Physijs.CylinderMesh(geo,mat4,0);
        cylinder4.position.x = StartX+40;
        cylinder4.position.y = StartY;
        cylinder4.position.z = StartZ-30;
        wholeBarrier.add(cylinder4);
        scene.add(wholeBarrier);
     return wholeBarrier;
    }
        var barrier1 = CreateBarrier(0,20,250);
        barrier1.rotation.z = -0.5*Math.PI;
        barrier1.position.x = -10;
        barrier1.position.y = 180;
        scene.add(barrier1);
        var barrier2 = CreateBarrier(0,20,-250);
        barrier2.rotation.z = -0.5*Math.PI;
        barrier2.position.x = -10;
        barrier2.position.y = 180;
        scene.add(barrier2);
        var barrier3= CreateBarrier(-230,10,20);
        barrier3.rotation.x = -0.5*Math.PI;
        barrier3.position.x = 450;
        barrier3.position.y = 100;
        scene.add(barrier3);
        var barrier4= CreateBarrier(150,10,20);
        barrier4.rotation.x = -0.5*Math.PI;
        barrier4.position.x = -450;
        barrier4.position.y = 100;
        scene.add(barrier4);

        var tbGeo = new THREE.BoxGeometry(430,80,30);
        var tbMesh = new THREE.MeshNormalMaterial();
        var tbarrier1 = new Physijs.BoxMesh(tbGeo,tbMesh,0);
        tbarrier1.position.z = -225;
        tbarrier1.position.x = -10;
        tbarrier1.position.y =45;
        scene.add(tbarrier1);

         var coverGeo = new THREE.BoxGeometry(430,80);
         var ctexture1 = new THREE.TextureLoader().load("../Resources/Textures/Razeen/abstract.jpg");
         var cMesh1 = new THREE.MeshLambertMaterial({map:ctexture1});
         var cover1 = new THREE.Mesh(coverGeo,cMesh1);
            cover1.position.z = -210;
            cover1.position.x = -10;
            cover1.position.y =45;
            scene.add(cover1);


         var tbarrier2 = new Physijs.BoxMesh(tbGeo,tbMesh,0);
         tbarrier2.position.z = 225;
         tbarrier2.position.x = -10;
         tbarrier2.position.y = 45;
         scene.add(tbarrier2);

    var ctexture2 = new THREE.TextureLoader().load("../Resources/Textures/Razeen/abstract2.jpg");
    var cMesh2 = new THREE.MeshLambertMaterial({map:ctexture2});
    var cover2 = new THREE.Mesh(coverGeo,cMesh2);
    cover2.position.z = 210;
    cover2.position.x = -10;
    cover2.position.y =45;
    scene.add(cover2);

         var tbarrier3 = new Physijs.BoxMesh(tbGeo,tbMesh,0);
         tbarrier3.rotation.y = -0.5*Math.PI;
         //tbarrier3.position.z = 225;
         tbarrier3.position.x = -225;
         tbarrier3.position.y = 45;
         scene.add(tbarrier3);

    var ctexture3 = new THREE.TextureLoader().load("../Resources/Textures/Razeen/love.jpg");
    var cMesh3 = new THREE.MeshLambertMaterial({map:ctexture3});
    var cover3 = new THREE.Mesh(coverGeo,cMesh3);
    //cover3.position.z = 210;
    cover3.rotation.y = -0.5*Math.PI;
    cover3.position.x = -210;
    cover3.position.y =45;
    scene.add(cover3);

         var tbarrier4 = new Physijs.BoxMesh(tbGeo,tbMesh,0);
         tbarrier4.rotation.y = -0.5*Math.PI;
    //tbarrier3.position.z = 225;
         tbarrier4.position.x = 225;
         tbarrier4.position.y = 45;
        scene.add(tbarrier4);

    var ctexture4 = new THREE.TextureLoader().load("../Resources/Textures/Razeen/astronaut.jpg");
    var cMesh4 = new THREE.MeshLambertMaterial({map:ctexture4});
    var cover4 = new THREE.Mesh(coverGeo,cMesh4);
    //cover3.position.z = 210;
    cover4.rotation.y = -0.5*Math.PI;
    cover4.position.x = 210;
    cover4.position.y =45;
    scene.add(cover4);


    var loader = new THREE.GLTFLoader();
   // var light2 = new THREE.AmbientLight();
   //
   //  loader.load("../Models/sci-fi_lantern/scene.gltf", function (object) {
   //      let lantern = object.scene.children[0];
   //      lantern.rotation.x = -0.5*Math.PI;
   //      lantern.position.y = 20;
   //      lantern.position.z = 220;
   //      lantern.position.x = -225;
   //      lantern.scale.set(15,15,15);
   //      scene.add(lantern);
   //  });
   //
   //  loader.load("../Models/low_poly_glowing_mushroom/scene.gltf", function (object) {
   //      let shroom = object.scene.children[0];
   //      shroom.rotation.x = -0.5*Math.PI;
   //      shroom.position.x = 225;
   //      shroom.position.y = 70;
   //      shroom.position.z = 220;
   //      shroom.scale.set(60,80,50);
   //      scene.add(shroom);
   //  });
   //
   //  loader.load("../Models/mushroom/scene.gltf", function (object) {
   //      let shroom2 = object.scene.children[0];
   //      shroom2.rotation.x = -0.5*Math.PI;
   //      shroom2.position.x = 225;
   //      shroom2.position.y = 100;
   //      shroom2.position.z = -400;
   //      shroom2.scale.set(60,80,50);
   //      scene.add(shroom2);
   //  });
   //
   //  loader.load("../Models/subwoofer/scene.gltf", function (object) {
   //      let speaker = object.scene.children[0];
   //      speaker.rotation.x = -0.5*Math.PI;
   //      speaker.rotation.z = 0.25*Math.PI;
   //      speaker.position.x = -225;
   //      speaker.position.y = 250;
   //      speaker.position.z = -260;
   //      speaker.scale.set(5,5,5);
   //      scene.add(speaker);
   //  });
    var texturePlan = new THREE.TextureLoader().load("../Resources/Textures/Razeen/lblue.jpg");
    var planGeo = new THREE.SphereGeometry(300,450,450);
    var planMesh = new THREE.MeshPhongMaterial({
        shininess: 0.8,
        //emissive : 0xFF091C,
        //emissiveIntensity: 0.4,
        specular: 0xf0f0f0,
        color: 0x069AFA,
        map: texturePlan
    });

     var planet = new THREE.Mesh(planGeo,planMesh);
     planet.position.y = 800;
    // scene.add(planet);

    var textureURLs = [  // URLs of the six faces of the cubeMap map

        "../Resources/CubeMaps/red/bkg1_right1.png",   // Note:  The order in which
        "../Resources/CubeMaps/red/bkg1_left2.png",   //   the images are listed is
        "../Resources/CubeMaps/red/bkg1_top3.png",   //   important!
        "../Resources/CubeMaps/red/bkg1_bottom4.png",
        "../Resources/CubeMaps/red/bkg1_front5.png",
        "../Resources/CubeMaps/red/bkg1_back6.png"
    ];
    var materials = [];
    for (var i = 0; i < 6; i++) {
        var texture = new THREE.TextureLoader().load( textureURLs[i] );
        materials.push( new THREE.MeshBasicMaterial( {
            color: "white",
            side: THREE.DoubleSide,

            map: texture
        } ) );

    }

    // cubeMap = new THREE.Mesh( new THREE.CubeGeometry(5000,5000,5000),
    //     materials );
    // scene.add(cubeMap);

    camera.position.x = 0;
    camera.position.y = 100;
    camera.position.z = 150;
    //camera.lookAt();

    var controls=new THREE.OrbitControls(camera,renderer.domElement);

    //Ray Caster Code
    var mouseCoords = new THREE.Vector2();
    var raycaster = new THREE.Raycaster();

    function doMouse(event) {
        mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
        mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

        // update the picking ray with the camera and mouse position
        raycaster.setFromCamera(mouse, camera);

        // calculate objects intersecting the picking ray

        let intersects = raycaster.intersectObjects(scene.children);

        if (intersects[0] != null) {
           console.log('working');
        }
    }

    function updateFrame() {
        planet.rotation.x += 0.1;
        planet.rotation.y += 0.1;
    }

    var animate = function () {
        frameNumber++;
        updateFrame();

        if (frameNumber >= 30) {
            frameNumber = 0;
        }
        if (frameNumber >= 0 && frameNumber < 15) {

            barrier1.children[0].position.y += 0.5;
            barrier1.children[1].position.y -= 0.5;
            barrier1.children[2].position.y += 0.5;
            barrier1.children[3].position.y -= 0.5;

            barrier2.children[0].position.y += 0.5;
            barrier2.children[1].position.y -= 0.5;
            barrier2.children[2].position.y += 0.5;
            barrier2.children[3].position.y -= 0.5;

            barrier3.children[0].position.y += 0.5;
            barrier3.children[1].position.y -= 0.5;
            barrier3.children[2].position.y += 0.5;
            barrier3.children[3].position.y -= 0.5;

            barrier4.children[0].position.y += 0.5;
            barrier4.children[1].position.y -= 0.5;
            barrier4.children[2].position.y += 0.5;
            barrier4.children[3].position.y -= 0.5;
        }

        else if (frameNumber >= 15 && frameNumber < 30) {

            barrier1.children[0].position.y -= 0.5;
            barrier1.children[1].position.y += 0.5;
            barrier1.children[2].position.y -= 0.5;
            barrier1.children[3].position.y += 0.5;

            barrier2.children[0].position.y -= 0.5;
            barrier2.children[1].position.y += 0.5;
            barrier2.children[2].position.y -= 0.5;
            barrier2.children[3].position.y += 0.5;

            barrier3.children[0].position.y -= 0.5;
            barrier3.children[1].position.y += 0.5;
            barrier3.children[2].position.y -= 0.5;
            barrier3.children[3].position.y += 0.5;

            barrier4.children[0].position.y -= 0.5;
            barrier4.children[1].position.y += 0.5;
            barrier4.children[2].position.y -= 0.5;
            barrier4.children[3].position.y += 0.5;

        }

        scene.simulate();
        requestAnimationFrame( animate );
        controls.update();
        renderer.render( scene, camera );
    };
    animate();

    function init() {
        window.addEventListener("mousedown",doMouse,false);
        requestAnimationFrame(animate());
    }
</script>
<script src = "Moonstall.js"></script>
</body>
</html>