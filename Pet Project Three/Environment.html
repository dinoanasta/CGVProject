<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<script src = "js/three.js"></script>
<script src = "js/OrbitControls.js"></script>
<script src = "js/physi.js"></script>
<script src = "js/GLTFLoader.js"></script>
<script>


    Physijs.scripts.worker =  'js/physijs_worker.js';
    //Physijs.scripts.ammo = 'js/ammo.js';
    var frameNumber = 0;
    var cylinder1, cylinder2,cylinder3,cylinder4;
    var renderer = new THREE.WebGLRenderer({antialias:true});
    var camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 10000 );
    // var scene = new THREE.Scene();
    var scene = new Physijs.Scene;
    scene.setGravity(new THREE.Vector3(0,-10,0));

    // renderer.setSize( 1000, 800);
    renderer.setSize(window.innerWidth,window.innerHeight);
    document.body.appendChild( renderer.domElement );

    renderer.setClearColor(0xFFFFFF); //0x07E2E9
    var light;  // A light shining from the direction of the camera; moves with the camera.
    light = new THREE.DirectionalLight(0xFFFFFF,0.6);
    light.position.set(0,0,1);
    camera.add(light);
    scene.add(camera);

    function Plane() {
        var texture = new THREE.TextureLoader().load('textures/BlackBlocks.jpg');
        var surfaceMaterial = new THREE.MeshLambertMaterial({       color: 0xE6E686,
            specular: 0x222222,
            shininess: 16,
            shading: THREE.FlatShading,
            map: texture
        });
       // map: THREE.ImageUtils.loadTexture('textures/grass.jpg')
        var surfaceGeometry = new THREE.PlaneGeometry(1000,1000,100,100);
        var ground = new Physijs.createMaterial(surfaceMaterial,0.1,50);
        var value = 0;

        var groundShape = new Physijs.HeightfieldMesh(surfaceGeometry,surfaceMaterial,0,100,100);
        groundShape.rotation.x = -0.5*Math.PI;
        return groundShape;
    }

    scene.add(Plane());

    function CreateBarrier(StartX,StartY, StartZ) {
        var wholeBarrier = new THREE.Object3D();

        var texture1 = new THREE.TextureLoader().load("textures/yellow.jpg");
        var texture2 = new THREE.TextureLoader().load("textures/red.jpg");
        var texture3 = new THREE.TextureLoader().load("textures/purple.jpg");
        var texture4 = new THREE.TextureLoader().load("textures/blue2.jpg");
        var geo = new THREE.CylinderGeometry(10,10,700,50,1000);

        var mat1 = new THREE.MeshPhongMaterial({
            shininess: 0.8,
            emissive : 0xFFFB09,
            emissiveIntensity: 0.4,
            color: 0xFFFFFF,
            map: texture1
        });
        var mat2 = new THREE.MeshPhongMaterial({
            shininess: 0.8,
            emissive : 0xFF091C,
            emissiveIntensity: 0.4,
            specular: 0xf0f0f0,
            color: 0xFFFFFF,
            map: texture2
        });
        var mat3 = new THREE.MeshPhongMaterial({
            shininess: 0.8,
            emissive : 0x9207AB,
            emissiveIntensity: 0.4,
            specular: 0xf0f0f0,
            color: 0xFFFFFF,
            map: texture3
        });
        var mat4 = new THREE.MeshPhongMaterial({
            shininess: 0.8,
            emissive : 0x069AFA,
            emissiveIntensity: 0.4,
            specular: 0xf0f0f0,
            color: 0xFFFFFF,
            map: texture4
        });
        cylinder1 = new Physijs.CylinderMesh(geo,mat1,0);
        cylinder1.position.x = StartX;
        cylinder1.position.y = StartY;
        cylinder1.position.z = StartZ;
        wholeBarrier.add(cylinder1);

         cylinder2 = new Physijs.CylinderMesh(geo,mat2,0);
        cylinder2.position.x = StartX+40;
        cylinder2.position.y = StartY;
        cylinder2.position.z = StartZ+30;
        wholeBarrier.add(cylinder2);

        cylinder3 = new Physijs.CylinderMesh(geo,mat3,0);
        cylinder3.position.x = StartX+80;
        cylinder3.position.y = StartY;
        cylinder3.position.z = StartZ;
        wholeBarrier.add(cylinder3);

        cylinder4 = new Physijs.CylinderMesh(geo,mat4,0);
        cylinder4.position.x = StartX+40;
        cylinder4.position.y = StartY;
        cylinder4.position.z = StartZ-30;
        wholeBarrier.add(cylinder4);
        scene.add(wholeBarrier);
     return wholeBarrier;
    }
        var barrier1 = CreateBarrier(0,40,450);
        barrier1.rotation.z = -0.5*Math.PI;
        barrier1.position.x = -10;
        barrier1.position.y = 120;
        scene.add(barrier1);
        var barrier2 = CreateBarrier(0,40,-450);
        barrier2.rotation.z = -0.5*Math.PI;
        barrier2.position.x = -10;
        barrier2.position.y = 120;
        scene.add(barrier2);
        var barrier3= CreateBarrier(0,40,10);
        barrier3.rotation.x = -0.5*Math.PI;
        barrier3.position.x = 450;
        barrier3.position.y = 70;
        scene.add(barrier3);
        var barrier4= CreateBarrier(0,40,10);
        barrier4.rotation.x = -0.5*Math.PI;
        barrier4.position.x = -450;
        barrier4.position.y = 70;
        scene.add(barrier4);

    var loader = new THREE.GLTFLoader();
   // var light2 = new THREE.AmbientLight();

    loader.load("models/sci-fi_lantern/scene.gltf", function (object) {
        let lantern = object.scene.children[0];
        lantern.rotation.x = -0.5*Math.PI;
        lantern.position.y = 5;
        lantern.position.z = 440;
        lantern.position.x = -450;
        lantern.scale.set(20,20,20);
        scene.add(lantern);
    });

    loader.load("models/low_poly_glowing_mushroom/scene.gltf", function (object) {
        let shroom = object.scene.children[0];
        shroom.rotation.x = -0.5*Math.PI;
        shroom.position.x = 450;
        shroom.position.y = 0;
        shroom.position.z = 440;
        shroom.scale.set(30,50,30);
        scene.add(shroom);
    });

    loader.load("models/mushroom/scene.gltf", function (object) {
        let shroom2 = object.scene.children[0];
        shroom2.rotation.x = -0.5*Math.PI;
        shroom2.position.x = 450;
        shroom2.position.y = 70;
        shroom2.position.z = -440;
        shroom2.scale.set(30,50,30);
        scene.add(shroom2);
    });

    loader.load("models/subwoofer/scene.gltf", function (object) {
        let speaker = object.scene.children[0];
        speaker.rotation.x = -0.5*Math.PI;
        speaker.rotation.z = 0.25*Math.PI;
        speaker.position.x = -450;
        speaker.position.y = 150;
        speaker.position.z = -440;
        speaker.scale.set(5,5,5);
        scene.add(speaker);
    });
    var texturePlan = new THREE.TextureLoader().load("textures/lblue.jpg");
    var planGeo = new THREE.SphereGeometry(300,450,450);
    var planMesh = new THREE.MeshPhongMaterial({
        shininess: 0.8,
        //emissive : 0xFF091C,
        //emissiveIntensity: 0.4,
        specular: 0xf0f0f0,
        color: 0x069AFA,
        map: texturePlan
    });

    var planet = new THREE.Mesh(planGeo,planMesh);
    planet.position.y = 1000;
    scene.add(planet);

    var textureURLs = [  // URLs of the six faces of the cubeMap map
        "CubeMaps/skybox (1)/right.png",   // Note:  The order in which
        "CubeMaps/skybox (1)/left.png",   //   the images are listed is
        "CubeMaps/skybox (1)/top.png",   //   important!
        "CubeMaps/skybox (1)/bottom.png",
        "CubeMaps/skybox (1)/back.png",
        "CubeMaps/skybox (1)/front.png",
    ];
    var materials = [];
    for (var i = 0; i < 6; i++) {
        var texture = new THREE.TextureLoader().load( textureURLs[i] );
        materials.push( new THREE.MeshBasicMaterial( {
            color: "white",  // Color will be multiplied by texture color.
            side: THREE.DoubleSide,  // IMPORTANT: To see the inside of the cubeMap,
                                     //            back faces must be rendered!
            map: texture
        } ) );

    }

    cubeMap = new THREE.Mesh( new THREE.CubeGeometry(10000,10000,10000),
        materials );
    scene.add(cube);


    // barriers[1].position.x = 0;
    // barriers[1].position.y= 40;
    // barriers[1].position.z = -480;
    // barriers[1].rotation.z = 0.5*Math.PI;
    // scene.add(barriers[1]);
    //
    // barriers[2].position.x = -480;
    // barriers[2].position.y= 40;
    // barriers[2].rotation.x = 0.5*Math.PI;
    // scene.add(barriers[2]);
    //
    // barriers[3].position.x = 480;
    // barriers[3].position.y= 40;
    // barriers[3].rotation.x = 0.5*Math.PI;
    // scene.add(barriers[3]);

    camera.position.x = 0;
    camera.position.y = 100;
    camera.position.z = 150;
    //camera.lookAt();

    var controls=new THREE.OrbitControls(camera,renderer.domElement);
    var stopMove1 = 43;
    var stopMove2 = 37;

    function updateForFrame() {

        var loopFrame = frameNumber % 240;
        if (loopFrame > 120) {
            loopFrame = 240 - loopFrame;
        }

        planet.rotation.x += 0.1;
        planet.rotation.y += 0.1;
    }

    var animate = function () {
        frameNumber++;
        updateForFrame();
        // if(cylinder1.position.y !== stopMove1)
        // {
        //     cylinder1.position.y += -0.5;
        //     cylinder2.position.y += 0.5;
        //     cylinder3.position.y += -0.5;
        //     cylinder4.position.y += 0.5;
        //
        // }
        // else if (cylinder1.position.y !== stopMove2){
        //     cylinder1.position.y += 0.5;
        //     cylinder2.position.y += -0.5;
        //     cylinder3.position.y += 0.5;
        //     cylinder4.position.y += -0.5;
        // }
        scene.simulate();
        requestAnimationFrame( animate );
        controls.update();
        renderer.render( scene, camera );
    };

    // var axes = new THREE.AxesHelper(30);
    // scene.add(axes);
    // var landGeo = new THREE.PlaneGeometry(60,60,32);
    // var landMat = new THREE.MeshLambertMaterial({color: 0x11fa46});
    // var land = new Physijs.BoxMesh(landGeo,landMat);
    // land.rotation.x = -0.5*Math.PI;
    // scene.add(land);

    // var loader = new THREE.GLTFLoader();
    // var light2 = new THREE.AmbientLight();

    // loader.load("models/scene.gltf", function (object) {
    //     let wolf = object.scene.children[0];
    //     wolf.rotation.x = -0.5*Math.PI;
    //     wolf.position.y = 5;
    //     wolf.position.z = 5;
    //     wolf.scale.set(10,10,10);
    //     scene.add(wolf);
    // });

    // var textureURLs = [  // URLs of the six faces of the cubeMap map
    //
    //     "red/bkg1_right1.png",   // Note:  The order in which
    //     "red/bkg1_left2.png",   //   the images are listed is
    //     "red/bkg1_top3.png",   //   important!
    //     "red/bkg1_bottom4.png",
    //     "red/bkg1_back6.png",
    //     "red/bkg1_front5.png"
    // ];

    //  "blue/bkg1_right.png",   // Note:  The order in which
    // "blue/bkg1_left.png",   //   the images are listed is
    //     "blue/bkg1_top.png",   //   important!
    //     "blue/bkg1_bottom.png",
    //     "blue/bkg1_back.png",
    //     "blue/bkg1_front.png"

    // "lightblue/right.png",   // Note:  The order in which
    //     "lightblue/left.png",   //   the images are listed is
    //     "lightblue/top.png",   //   important!
    //     "lightblue/bot.png",
    //     "lightblue/back.png",
    //     "lightblue/front.png"

    // "red/bkg1_right1.png",   // Note:  The order in which
    //     "red/bkg1_left2.png",   //   the images are listed is
    //     "red/bkg1_top3.png",   //   important!
    //     "red/bkg1_bottom4.png",
    //     "red/bkg1_back6.png",
    //     "red/bkg1_front5.png"

    // var materials = [];
    // for (var i = 0; i < 6; i++) {
    //     var texture = new THREE.TextureLoader().load( textureURLs[i] );
    //     materials.push( new THREE.MeshBasicMaterial( {
    //         color: "white",  // Color will be multiplied by texture color.
    //         side: THREE.DoubleSide,  // IMPORTANT: To see the inside of the cubeMap,
    //                                  //            back faces must be rendered!
    //         map: texture
    //     } ) );
    //
    // }
    //
    // cubeMap = new THREE.Mesh( new THREE.CubeGeometry(10000,10000,10000),
    //     materials );
    // scene.add(cubeMap);
    animate();
</script>
</body>
</html>