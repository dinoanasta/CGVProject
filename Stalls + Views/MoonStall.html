<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Carnival</title>

    <style>
        body{
            margin:0;
            overflow: hidden;
        }
        canvas{
            background: red;

        }

    </style>
</head>
<body>

<canvas id = "myCanvas"></canvas>

<script src = "../js/three.js"></script>
<script>



    var renderer = new THREE.WebGLRenderer({canvas : document.getElementById('myCanvas'), antialias: true});
    renderer.setClearColor(0x000000);
    renderer.setPixelRatio(window.devicePixelRatio);
    renderer.setSize(window.innerWidth,window.innerHeight -50);

    var camera = new THREE.PerspectiveCamera(35, window.innerWidth / window.innerHeight, 0.1,4000);
    camera.position.z = 1000;

    var scene = new THREE.Scene();

    var light = new THREE.AmbientLight(0xffffff,0.5);
    scene.add(light);

    var light1 = new THREE.PointLight(0xffffff,0.5);
    scene.add(light1);

    var textureLoader = new THREE.TextureLoader();
    var moonText;

    var stall = makeStall();
    stall.position.z = -300;
    makeText();


    stall.add(makeText());
    stall.add(miniGame());
    scene.add(stall);


    requestAnimationFrame(render);

    function render(){

        //moonText.rotation.y += 0.01;
        // Animating sphere 1

        renderer.render(scene,camera);
        requestAnimationFrame(render);
    }

    renderer.render(scene,camera);


    function makeText(){

        var loader = new THREE.FontLoader();

        loader.load('../Resources/Fonts/droid_serif_bold.typeface.json',function (font) {
            var geoText = new THREE.TextBufferGeometry( "1" , {
                font : font,
                size : 30,
                height : 20,
                curveSegments: 16,
                bevelEnabled : true,
                bevelThickness: 5,
                bevelSize: 5,
                bevelOffset : 0,
                bevelSegments: 4

            });

            var matText = new THREE.MeshNormalMaterial({
                color : 'white'
            })

            text = new THREE.Mesh(geoText,matText);
            text.position.y = 230;
            text.position.z = 100;

        })
    }

    function makeMoon(){

        var moonGeo = new THREE.SphereGeometry(75,200,200);
        var moonMat = new THREE.MeshBasicMaterial({ map : textureLoader.load('../Resources/Textures/Mikayla/moon7.jfif')});

        var moon = new THREE.Mesh(moonGeo,moonMat);
        moon.position.y = 300;
        moon.position.z = 100;

        stall.add(moon);


        requestAnimationFrame(render);

        function render(){

            moon.rotation.y += 0.01;
            renderer.render(scene,camera);
            requestAnimationFrame(render);
        }
        renderer.render(scene,camera);

    }

    function miniGame(){

        var geoWall1 = new THREE.BoxBufferGeometry(400,200,10);
        var geoWall2 = new THREE.BoxBufferGeometry(300,150,10);
        var matWall = new THREE.MeshBasicMaterial({ map : textureLoader.load('../Resources/Textures/Mikayla/neontexture1.jpg')});

        var game = new THREE.Mesh(geoWall1,matWall);
        var side1 = new THREE.Mesh(geoWall2,matWall);
        side1.position.x = -190;
        side1.position.y = -50;
        side1.position.z = 150;
        side1.rotation.y = Math.PI/2;
        var side2 = side1.clone();
        side2.position.x = 190;
        game.add(side1);
        game.add(side2);
        game.position.y = -50;

        return game;

    }


    function makeStall(){

        var stall = makeWall2();

        var wall = makeWall();
        wall.position.x = 200;
        wall.position.z = 150;
        wall.rotation.y = Math.PI/2;

        var wall2 = makeWall();
        wall2.position.x = -200;
        wall2.position.z = 150;
        wall2.rotation.y = Math.PI/2;

        var roof = makeRoof();
        roof.position.y = 185;
        roof.position.z = 100;
        roof.rotation.y = Math.PI/4;

        var geo = new THREE.PlaneGeometry(1000,1000);
        var mat = new THREE.MeshBasicMaterial({
            color : 'gray'
        });
        var plane = new THREE.Mesh(geo,mat);
        plane.position.y = -150;
        //plane.position.x = -50;
        plane.position.z = 200;
        plane.rotation.x = -Math.PI/2;

        stall.add(wall);
        stall.add(wall2);
        stall.add(roof);
        stall.add(plane);

        return stall;
    }

    function rotateStall(moonStall){

        stall.position.y = 50;
        stall.position.z = -300;
        stall.rotation.y = -Math.PI/8;
        stall.rotation.x = Math.PI/8;
    }

    function makeRoof(){

        var geometry = new THREE.ConeGeometry(350,75,4);
        var material = new THREE.MeshBasicMaterial({ map : textureLoader.load('../Resources/Textures/Mikayla/right.png')});

        return new THREE.Mesh(geometry,material);
    }

    function makeWall2(){

        var geoWall = new THREE.CubeGeometry(400,300,10);
        var matWall = new THREE.MeshBasicMaterial({ map : textureLoader.load('../Resources/Textures/Mikayla/right.png')});

        return new THREE.Mesh(geoWall,matWall);
    }

    function makeWall(){

        var geoWall = new THREE.CubeGeometry(300,300,10);
        var matWall = new THREE.MeshBasicMaterial({ map : textureLoader.load('../Resources/Textures/Mikayla/right.png')});

        return new THREE.Mesh(geoWall,matWall);
    }


    function doViewCheckbox() {
        var run = document.getElementById("viewCheckbox").checked;
        if (run) {


            camera.rotation.x = -Math.PI/2;
            camera.rotation.z = Math.PI;
            camera.position.x = -300;
            camera.position.y = 3000;
            camera.position.z = -100;

            renderer.render(scene,camera);

        }
    }

    function doRotateCheckbox() {
        var run = document.getElementById("rotateCheckbox").checked;
        if (run) {

            rotateStall(stall);
            renderer.render(scene,camera);

        }
    }
</script>

<p>
    <label><input type="checkbox" id="viewCheckbox" onclick="doViewCheckbox()"><b>Birds Eye View</b></label>
    <label><input type="checkbox" id="rotateCheckbox" onclick="doRotateCheckbox()"><b>Angled View</b></label>

</p>

</body>
</html>